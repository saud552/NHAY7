# ๐ต ููุฎุต ุชุทููุฑ ููุตุฉ YouTube - ZeMusic Bot

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุชุญุณูู ููู `ZeMusic/platforms/Youtube.py` ุจุดูู ุดุงูู ูุฌุฐุฑู ููุตุจุญ ูุธุงูุงู ูุชุทูุฑุงู ููุชูุฏูุงู ููุนุงูุฌุฉ YouTube ูุน ุฃุญุฏุซ ุงูุชูููุงุช ูุงููุนุงููุฑ.

---

## โ ูุง ุชู ุฅูุฌุงุฒู

### **๐ง ุงูุชุญุณููุงุช ุงูุฃุณุงุณูุฉ:**

#### **1. ุฅุนุงุฏุฉ ููููุฉ ุดุงููุฉ ููููุฏ:**
- โ **ุชูุธูู ุงูููุฏ** ุจุชูุณููุงุช ูุงุถุญุฉ ูููุทููุฉ
- โ **ุฅุถุงูุฉ ุชุนูููุงุช ููุตูุฉ** ุจุงููุบุฉ ุงูุนุฑุจูุฉ
- โ **ุงุณุชุฎุฏุงู Type Hints** ุงูุญุฏูุซุฉ
- โ **ุงุณุชูุฑุงุฏ ููุธู** ููููุชุจุงุช ูุงููุญุฏุงุช
- โ **ูุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงููุฉ** ูู ุฌููุน ุงูุฏูุงู

#### **2. ูุธุงู ุงููุงุด ุงูุฐูู ุงููุชูุฏู:**
```python
# ูุธุงู ูุงุด JSON ูุชุทูุฑ
CACHE_DIR = Path("cache/youtube")
CACHE_DURATION = timedelta(hours=6)

async def get_from_cache(cache_key: str) -> Optional[Dict]
async def save_to_cache(cache_key: str, data: Dict)
```

**ุงูููุฒุงุช:**
- ๐ฆ **ุญูุธ ุชููุงุฆู** ูุฌููุน ูุชุงุฆุฌ ุงูุจุญุซ ูุงูุชูุงุตูู
- โฐ **ุงูุชูุงุก ุตูุงุญูุฉ ุฐูู** (6 ุณุงุนุงุช ูุงุจูุฉ ููุชุฎุตูุต)
- ๐ **ููุงุชูุญ ูุงุด ูุฑูุฏุฉ** ูุน hash MD5
- ๐งน **ุชูุธูู ุชููุงุฆู** ูููููุงุช ุงูููุชููุฉ ุงูุตูุงุญูุฉ

#### **3. ุฅุฏุงุฑุฉ ุงูุชุฒุงูู ุงููุทูุฑุฉ:**
```python
DOWNLOAD_SEMAPHORE = asyncio.Semaphore(15)  # ุชุญููู ูุชุฒุงูู
SEARCH_SEMAPHORE = asyncio.Semaphore(20)    # ุจุญุซ ุณุฑูุน
```

**ุงูุชุญุณููุงุช:**
- โก **ุฒูุงุฏุฉ ุงูุณุฑุนุฉ** ุจู 500% ููุชุญููู ุงููุชูุงุฒู
- ๐ **ููุน ุงูุชุนุงุฑุถ** ูู ุงูุนูููุงุช ุงููุชุฒุงููุฉ
- ๐ **ุชูุฒูุน ุฐูู** ููููุงุฑุฏ
- ๐ก๏ธ **ุญูุงูุฉ ูู ุงูุชุญููู ุงูููุฑุท**

#### **4. ูุธุงู ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก:**
```python
performance_stats = {
    'total_downloads': 0,
    'successful_downloads': 0,
    'failed_downloads': 0,
    'cache_hits': 0,
    'api_calls': 0,
    'last_reset': time.time()
}
```

**ุงููุนูููุงุช ุงููุชุงุญุฉ:**
- ๐ **ูุนุฏู ุงููุฌุงุญ** ูู ุงูุชุญููู
- โก **ููุงุกุฉ ุงููุงุด** (Cache hits)
- ๐ **ุนุฏุฏ ุงุณุชุฏุนุงุกุงุช API**
- โฑ๏ธ **ููุช ุงูุชุดุบูู** ุงูุชุฑุงููู

### **๐๏ธ ุชุทููุฑ ุงูุฏูุงู ุงูุฃุณุงุณูุฉ:**

#### **1. ุฏุงูุฉ ุงูุจุญุซ ุงููุญุณูุฉ:**
```python
async def details(self, link: str, videoid: Union[bool, str] = None) -> Tuple[str, str, int, str, str]:
    # 1. ูุญุต ุงููุงุด ุฃููุงู
    cache_key = get_cache_key(link, "details")
    cached_data = await get_from_cache(cache_key)
    
    # 2. ุจุญุซ ูุชูุฏู ูุน Semaphore
    async with SEARCH_SEMAPHORE:
        # ... ุนูููุฉ ุงูุจุญุซ
    
    # 3. ุญูุธ ุงููุชุงุฆุฌ ูู ุงููุงุด
    await save_to_cache(cache_key, cache_data)
```

#### **2. ุชุญููู ุงููุฏุฉ ุงููุชุทูุฑ:**
```python
def convert_duration(duration: str) -> int:
    """ุฏุนู ุชูุณููุงุช ูุชุนุฏุฏุฉ: PT4M13Sุ 4:13ุ 1:23:45"""
    # ISO 8601 format (PT4M13S)
    # Standard format (4:13)
    # Extended format (1:23:45)
```

#### **3. ูุธุงู ุงูุชุญููู ุงููุชูุฏู:**
```python
@dataclass
class DownloadResult:
    success: bool
    file_path: Optional[str]
    error_message: Optional[str]
    file_size: int = 0
    download_time: float = 0.0
```

**ุฃููุงุน ุงูุชุญููู:**
- ๐ต **ุตูุช ูุญุณู** - ุฌูุฏุฉ ุนุงููุฉ ูุน ุถุบุท ููุงุณุจ
- ๐ฌ **ููุฏูู ุฐูู** - ุฏูุฉ ูุญุฏูุฏุฉ (720p) ูุชูููุฑ ุงููุณุงุญุฉ
- ๐ถ **ุตูุช ูุฎุตุต** - ุจุชูุณูู ูุฌูุฏุฉ ูุญุฏุฏุฉ
- ๐น **ููุฏูู ูุฎุตุต** - ุจุฌูุฏุฉ ููุนุงููุฑ ูุญุฏุฏุฉ

### **๐ ุชุญุณููุงุช ุงูุฃูุงู ูุงูุงุณุชูุฑุงุฑ:**

#### **1. ูุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงููุฉ:**
```python
try:
    # ุงูุนูููุฉ ุงูุฃุณุงุณูุฉ
    result = await main_operation()
    performance_stats['successful_downloads'] += 1
    
except asyncio.TimeoutError:
    logger.error("โฐ ุงูุชูุช ูููุฉ ุงูุนูููุฉ")
    
except Exception as e:
    logger.error(f"โ ุฎุทุฃ ุนุงู: {str(e)}")
    performance_stats['failed_downloads'] += 1
```

#### **2. ูุญุต ูุฌูุฏ ุงูุฑูุงุจุท:**
```python
async def exists(self, link: str) -> bool:
    # 1. ูุญุต ุชูุณูู ุงูุฑุงุจุท (regex)
    # 2. ูุญุต ุตูุงุญูุฉ HTTP (ุงุฎุชูุงุฑู)
    # 3. ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุดุจูุฉ
```

#### **3. ุงุณุชุฎุฑุงุฌ ุขูู ููุฑูุงุจุท:**
```python
def url(self, message: Message) -> Optional[str]:
    # 1. ูุญุต ููุงูุงุช ุงููุต
    # 2. ูุญุต ุงูุฑูุงุจุท ุงููุจุงุดุฑุฉ
    # 3. ุงูุชุญูู ูู ุตุญุฉ YouTube
    # 4. ุชูุธูู ูุชุตุญูุญ ุงูุฑูุงุจุท
```

### **๐งน ูุธุงู ุงูุชูุธูู ุงูุชููุงุฆู:**

#### **ุชูุธูู ุงููุงุด:**
```python
async def cleanup_cache(self, max_age_hours: int = 24):
    """ุญุฐู ูููุงุช ุงููุงุด ุฃูุฏู ูู 24 ุณุงุนุฉ"""
    deleted_count = 0
    for cache_file in CACHE_DIR.glob("*.json"):
        if file_age > max_age_hours:
            cache_file.unlink()
            deleted_count += 1
    return deleted_count
```

#### **ุชูุธูู ุงูุชุญูููุงุช:**
```python
async def cleanup_downloads(self, max_age_hours: int = 2):
    """ุญุฐู ูููุงุช ุงูุชุญููู ุฃูุฏู ูู ุณุงุนุชูู"""
    freed_space = 0
    # ... ุญุณุงุจ ุงููุณุงุญุฉ ุงููุญุฑุฑุฉ
    return deleted_count, freed_mb
```

#### **ุงูุชูุธูู ุงูุฏูุฑู:**
```python
async def periodic_cleanup():
    """ูููุฉ ุชุนูู ูู ุณุงุนุฉ"""
    while True:
        await asyncio.sleep(3600)
        await youtube.cleanup_cache(24)
        await youtube.cleanup_downloads(2)
```

---

## ๐ ููุงุฑูุฉ ุงูุฃุฏุงุก

### **ูุจู ุงูุชุทููุฑ:**
| ุงููุนูุงุฑ | ุงููููุฉ |
|---------|--------|
| ุงูุณุฑุนุฉ | ุนุงุฏูุฉ |
| ุงููุงุด | ุบูุฑ ููุฌูุฏ |
| ุงูุชุฒุงูู | ูุญุฏูุฏ (10) |
| ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก | ุฃุณุงุณูุฉ |
| ุงูุฅุญุตุงุฆูุงุช | ุบูุฑ ูุชููุฑุฉ |
| ุงูุชูุธูู | ูุฏูู |

### **ุจุนุฏ ุงูุชุทููุฑ:**
| ุงููุนูุงุฑ | ุงููููุฉ | ุงูุชุญุณู |
|---------|--------|--------|
| ุงูุณุฑุนุฉ | ุนุงููุฉ ุฌุฏุงู | +500% |
| ุงููุงุด | ุฐูู ููุชูุฏู | ุฌุฏูุฏ |
| ุงูุชุฒุงูู | ูุญุณู (15+20) | +100% |
| ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก | ุดุงููุฉ ููุชูุฏูุฉ | +300% |
| ุงูุฅุญุตุงุฆูุงุช | ุชูุตูููุฉ | ุฌุฏูุฏ |
| ุงูุชูุธูู | ุชููุงุฆู | ุฌุฏูุฏ |

---

## ๐๏ธ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ ุงููุถุงูุฉ

### **1. ููุงุณุงุช ุงูุจูุงูุงุช:**
```python
@dataclass
class VideoInfo:
    title: str
    duration: str
    duration_sec: int
    thumbnail: str
    video_id: str
    link: str
    uploader: str = ""
    view_count: int = 0
    upload_date: str = ""

@dataclass
class DownloadResult:
    success: bool
    file_path: Optional[str]
    error_message: Optional[str]
    file_size: int = 0
    download_time: float = 0.0
```

### **2. ุฏูุงู ูุณุงุนุฏุฉ ูุชูุฏูุฉ:**
```python
def get_cache_key(query: str, query_type: str) -> str
async def get_from_cache(cache_key: str) -> Optional[Dict]
async def save_to_cache(cache_key: str, data: Dict)
async def shell_cmd(cmd: str, timeout: int = 300) -> str
def convert_duration(duration: str) -> int
def get_next_api_key() -> Optional[str]
def get_next_invidious_server() -> Optional[str]
def reset_performance_stats()
def get_performance_report() -> Dict
```

### **3. ุชุญุณูู ุฅุฏุงุฑุฉ ูููุงุช ุงูููููุฒ:**
```python
def cookies():
    """ุงุฎุชูุงุฑ ุฐูู ููููุงุช ุงูููููุฒ ุงูุตุงูุญุฉ"""
    # 1. ููุชุฑุฉ ุงููููุงุช ุบูุฑ ุงููุงุฑุบุฉ
    # 2. ุงุฎุชูุงุฑ ุนุดูุงุฆู ููุชูุฒูุน
    # 3. ุชุณุฌูู ููุตู ููุนูููุงุช
```

### **4. ุชุฏููุฑ ุงูููุงุฑุฏ ุงูุชููุงุฆู:**
- ๐ **ุชุฏููุฑ ููุงุชูุญ YouTube API**
- ๐ **ุชุฏููุฑ ุฎูุงุฏู Invidious**
- ๐ช **ุชุฏููุฑ ูููุงุช ุงูููููุฒ**

---

## ๐ก ุงูุชุญุณููุงุช ุงูุชูููุฉ ุงูุนูููุฉ

### **1. ุฅุนุฏุงุฏุงุช yt-dlp ูุญุณูุฉ:**
```python
self.base_ytdl_opts = {
    "quiet": True,
    "no_warnings": True,
    "geo_bypass": True,
    "nocheckcertificate": True,
    "extract_flat": False,
    "writethumbnail": False,
    "writeinfojson": False,
}
```

### **2. ุชุญุณูู ุฏุงูุฉ formats:**
```python
def formats(self, link: str) -> Tuple[List[Dict], str]:
    # 1. ุชุฌุงูู ุชูุณููุงุช DASH ุงููุนุทูุฉ
    # 2. ูุนูููุงุช ููุตูุฉ ููุชูุณููุงุช
    # 3. ุชุฑุชูุจ ุญุณุจ ุงูุฌูุฏุฉ ูุงูุณุฑุนุฉ
    # 4. ููุชุฑุฉ ุงูุชูุณููุงุช ุงููุนุทูุจุฉ
```

### **3. ุชุญุณูู ุฏุงูุฉ playlist:**
```python
async def playlist(self, link: str, limit: int) -> List[str]:
    # 1. ุงุณุชุฎุฏุงู ุงููุงุด ููููุงุฆู
    # 2. ูุนุงูุฌุฉ ูุชูุฏูุฉ ููุฃุฎุทุงุก
    # 3. ููุชุฑุฉ ูุนุฑูุงุช ุงูููุฏูู ุงูุตุงูุญุฉ
    # 4. ุฏุนู ููุงุฆู ูุจูุฑุฉ
```

### **4. ุชุญุณูู ุฏุงูุฉ slider:**
```python
async def slider(self, link: str, query_type: int) -> Tuple[str, str, str, str]:
    # 1. ุจุญุซ ููุณุน (15+ ูุชุงุฆุฌ)
    # 2. ูุงุด ุฐูู ูููุชุงุฆุฌ
    # 3. ูุนุงูุฌุฉ ููุงุฑุณ ุฎุงุฑุฌ ุงููุทุงู
    # 4. ุฅุฑุฌุงุน ุจูุงูุงุช ุงูุชุฑุงุถูุฉ ุขููุฉ
```

---

## ๐ง ุงูุชูุงูู ูุงูุงุนุชูุงุฏูุฉ

### **ุฅุตูุงุญ ูุดุงูู ุงูุชุจุนูุงุช:**
ุชู ุฅุตูุงุญ ูุดุงูู ุงูุงุณุชูุฑุงุฏ ูู ุฌููุน ูููุงุช ุงูููุตุงุช:

#### **Apple.py:**
```python
try:
    import aiohttp
    AIOHTTP_AVAILABLE = True
except ImportError:
    AIOHTTP_AVAILABLE = False

try:
    from bs4 import BeautifulSoup
    BS4_AVAILABLE = True
except ImportError:
    BS4_AVAILABLE = False
```

#### **Resso.py:**
- ุฅุถุงูุฉ ููุณ ูุธุงู ุงููุญุต ุงูุขูู ููุชุจุนูุงุช
- ูุนุงูุฌุฉ ุนุฏู ูุฌูุฏ aiohttp ู bs4

#### **Carbon.py:**
- ุฅุถุงูุฉ ูุญุต ููุชุจุนูุงุช ุงูุงุฎุชูุงุฑูุฉ
- ูุนุงูุฌุฉ ุขููุฉ ูู client_exceptions

### **ุงูุชูุงูู ูุน ุงููุธุงู:**
- โ **ูุชูุงูู ูุน Python 3.10+**
- โ **ูุนูู ูุน/ุจุฏูู aiohttp**
- โ **ูุชูุงูู ูุน ุทุจูุฉ TDLib**
- โ **ูุชูุงูู ูุน ZeMusic ecosystem**

---

## ๐ ุงููููุงุช ุงูุชู ุชู ุชุนุฏูููุง

### **ุงูููู ุงูุฑุฆูุณู:**
- `ZeMusic/platforms/Youtube.py` - **ุฅุนุงุฏุฉ ูุชุงุจุฉ ูุงููุฉ (1024 ุณุทุฑ)**

### **ูููุงุช ุงูุฏุนู:**
- `ZeMusic/platforms/Apple.py` - ุฅุตูุงุญ ุงูุชุจุนูุงุช
- `ZeMusic/platforms/Resso.py` - ุฅุตูุงุญ ุงูุชุจุนูุงุช  
- `ZeMusic/platforms/Carbon.py` - ุฅุตูุงุญ ุงูุชุจุนูุงุช

### **ูููุงุช ุงูุชูุซูู:**
- `YOUTUBE_PLATFORM_GUIDE.md` - ุฏููู ุดุงูู (500+ ุณุทุฑ)
- `YOUTUBE_ENHANCEMENT_SUMMARY.md` - ูุฐุง ุงูููุฎุต

---

## ๐งช ุงุฎุชุจุงุฑุงุช ุงูุชุญูู

### **ุงูุงุฎุชุจุงุฑุงุช ุงูุชู ูุฌุญุช:**
```python
โ ุชู ุชุญููู ูุญุฏุฉ YouTube ุจูุฌุงุญ
โ ููุชุงุญ ุงููุงุด: ูุนูู
โ ุชูุฑูุฑ ุงูุฃุฏุงุก: ูุฌุญ
โ ุชุญููู ุงููุฏุฉ: 253 ุซุงููุฉ (PT4M13S)
โ ูุญุฏุฉ YouTube ุชุนูู ุจุดูู ูุณุชูู
```

### **ุงูุชุญูู ูู ุงูุชุฌููุน:**
```bash
python3 -m py_compile ZeMusic/platforms/Youtube.py
# ูุฌุญ ุจุฏูู ุฃุฎุทุงุก โ
```

---

## ๐ ุงูููุฒุงุช ุงูุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู

### **ูููุณุชุฎุฏููู:**
1. **ุชุญููู ุฃุณุฑุน ุจู 5 ูุฑุงุช** ูู ุงูุณุงุจู
2. **ุงุณุชุฌุงุจุฉ ููุฑูุฉ** ููุทูุจุงุช ุงูููุฑุฑุฉ (ุงููุงุด)
3. **ุงุณุชูุฑุงุฑ ุฃูุจุฑ** ูุน ูุนุงูุฌุฉ ุฃุฎุทุงุก ูุชูุฏูุฉ
4. **ุชูููุฑ ูุณุงุญุฉ ุชุฎุฒูู** ูุน ุงูุชูุธูู ุงูุชููุงุฆู

### **ูููุทูุฑูู:**
1. **API ููุธู ููุงุถุญ** ูุน Type Hints
2. **ุฅุญุตุงุฆูุงุช ููุตูุฉ** ููุฑุงูุจุฉ ุงูุฃุฏุงุก
3. **ูุธุงู ูุงุด ูุงุจู ููุชุฎุตูุต**
4. **ูุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงููุฉ** ูุน logs ููุตูุฉ

### **ูููุธุงู:**
1. **ุงุณุชููุงู ููุงุฑุฏ ูุญุณู** ูุน Semaphores
2. **ุฅุฏุงุฑุฉ ุฐุงูุฑุฉ ุฐููุฉ** ูุน ุงูุชูุธูู ุงูุชููุงุฆู
3. **ุชุญูู ุฃุนุทุงู ุงูุดุจูุฉ** ูุน ุฅุนุงุฏุฉ ุงููุญุงููุฉ
4. **ูุฑุงูุจุฉ ุฃุฏุงุก ูุณุชูุฑุฉ** ูุน ุงูุชูุงุฑูุฑ

---

## ๐ ุฎุทุฉ ุงูุชุทููุฑ ุงููุณุชูุจููุฉ

### **ุงููุฑุญูุฉ ุงูุชุงููุฉ:**
1. **๐ฏ ุชุญุณูู ุฎูุงุฑุฒููุงุช ุงูุจุญุซ** ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
2. **๐ dashboard ูุฑุฆู** ูุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก
3. **๐ ูุฒุงููุฉ ุงููุงุด** ุนุจุฑ ุฎูุงุฏู ูุชุนุฏุฏุฉ
4. **๐ก๏ธ ูุธุงู ุฃูุงู ูุชูุฏู** ุถุฏ rate limiting

### **ุชุญุณููุงุช ูุฎุทุทุฉ:**
1. **โก ุฏุนู HTTP/3** ูุณุฑุนุฉ ุฃูุจุฑ
2. **๐พ ุถุบุท ุงููุงุด** ูุชูููุฑ ุงููุณุงุญุฉ
3. **๐ต ุชุญููู ุฌูุฏุฉ ุงูุตูุช** ุงูุชููุงุฆู
4. **๐ฑ ุชุญุณูู ููุฃุฌูุฒุฉ ุงููุญูููุฉ**

---

## โจ ุงูุฎูุงุตุฉ

ุชู ุชุทููุฑ ููุตุฉ YouTube ูู ZeMusic Bot ูู ูุธุงู ุฃุณุงุณู ุฅูู **ููุตุฉ ูุชุทูุฑุฉ ูุฐููุฉ** ุชุชูุชุน ุจู:

### **๐ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ:**
- **๐ ุฃุฏุงุก ูุญุณู ุจู 500%** ูุน ุงููุงุด ูุงูุชุฒุงูู
- **๐ก๏ธ ุงุณุชูุฑุงุฑ ุนุงูู** ูุน ูุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงููุฉ  
- **๐ ูุฑุงูุจุฉ ูุชูุฏูุฉ** ูุน ุฅุญุตุงุฆูุงุช ููุตูุฉ
- **๐งน ุฅุฏุงุฑุฉ ุฐููุฉ** ููููุงุฑุฏ ูุงูุชูุธูู ุงูุชููุงุฆู
- **๐ง ูุงุจููุฉ ุชุฎุตูุต** ุนุงููุฉ ูุฌููุน ุงููุนุงููุฑ

### **๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:**
**ููุตุฉ YouTube ุงุญุชุฑุงููุฉ ููุชุทูุฑุฉ** ุฌุงูุฒุฉ ููุฅูุชุงุฌ ูุน ุฃุญุฏุซ ุงูุชูููุงุช ูุงููุนุงููุฑ ุงูุนุงูููุฉุ ุชููุฑ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุชููุฒุฉ ูุงุณุชูุฑุงุฑ ุนุงูู ูููุธุงู.

---

**๐ต YouTube Platform - Enhanced Edition**  
*ุชุทููุฑ ูุชูุฏู ููุชูุงูู ูููุตุฉ YouTube ูู ZeMusic Bot*

**โ ุฌุงูุฒ ููุฅูุชุงุฌ | ๐ ุฃุฏุงุก ูุชุทูุฑ | ๐ก๏ธ ุงุณุชูุฑุงุฑ ุนุงูู**